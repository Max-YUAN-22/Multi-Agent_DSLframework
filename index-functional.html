<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼ä¸šçº§å¤šæ™ºèƒ½ä½“ç®¡ç†å¹³å° - åŠŸèƒ½ç‰ˆ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: white;
            border-radius: 12px;
            padding: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .nav-tab.active {
            background: #667eea;
            color: white;
        }

        .content-section {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f2ff;
        }

        .btn {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn.secondary {
            background: #6c757d;
        }

        .btn.danger {
            background: #dc3545;
        }

        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .form-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .agent-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .agent-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }

        .agent-name {
            font-size: 1.2em;
            font-weight: 700;
            color: #333;
        }

        .agent-type {
            color: #667eea;
            font-size: 0.9em;
            font-weight: 500;
        }

        .agent-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .status-running {
            background: #d4edda;
            color: #155724;
        }

        .status-idle {
            background: #fff3cd;
            color: #856404;
        }

        .agent-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 1.1em;
            font-weight: 700;
            color: #667eea;
        }

        .metric-label {
            font-size: 0.8em;
            color: #666;
        }

        .agent-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .agent-actions .btn {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .task-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .task-priority {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .priority-high {
            background: #f8d7da;
            color: #721c24;
        }

        .priority-medium {
            background: #fff3cd;
            color: #856404;
        }

        .priority-low {
            background: #d1ecf1;
            color: #0c5460;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #667eea;
            transition: width 0.3s ease;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
            .agent-metrics {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¤– ä¼ä¸šçº§å¤šæ™ºèƒ½ä½“ç®¡ç†å¹³å°</h1>
        <p>åŠŸèƒ½ç‰ˆ - çœŸæ­£å¯æ“ä½œçš„ç®¡ç†ç³»ç»Ÿ</p>
    </div>

    <div class="container">
        <div class="success-message">
            <i class="fas fa-check-circle"></i>
            åŠŸèƒ½ç‰ˆå¹³å°å·²å¯åŠ¨ï¼æ‚¨å¯ä»¥çœŸæ­£åˆ›å»ºã€ç¼–è¾‘å’Œç®¡ç†æ™ºèƒ½ä½“ä¸ä»»åŠ¡ã€‚
        </div>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('agents')">
                <i class="fas fa-robot"></i> æ™ºèƒ½ä½“ç®¡ç†
            </button>
            <button class="nav-tab" onclick="showSection('tasks')">
                <i class="fas fa-tasks"></i> ä»»åŠ¡ç®¡ç†
            </button>
            <button class="nav-tab" onclick="showSection('create-agent')">
                <i class="fas fa-plus"></i> åˆ›å»ºæ™ºèƒ½ä½“
            </button>
            <button class="nav-tab" onclick="showSection('create-task')">
                <i class="fas fa-plus-circle"></i> åˆ›å»ºä»»åŠ¡
            </button>
        </nav>

        <!-- æ™ºèƒ½ä½“ç®¡ç† -->
        <section id="agents" class="content-section active">
            <div class="section-header">
                <h2>æ™ºèƒ½ä½“ç®¡ç†</h2>
                <div>
                    <button class="btn" onclick="showSection('create-agent')">
                        <i class="fas fa-plus"></i> åˆ›å»ºæ™ºèƒ½ä½“
                    </button>
                    <button class="btn secondary" onclick="refreshAgents()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°
                    </button>
                </div>
            </div>

            <div id="agents-list">
                <!-- æ™ºèƒ½ä½“åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </section>

        <!-- ä»»åŠ¡ç®¡ç† -->
        <section id="tasks" class="content-section">
            <div class="section-header">
                <h2>ä»»åŠ¡ç®¡ç†</h2>
                <div>
                    <button class="btn" onclick="showSection('create-task')">
                        <i class="fas fa-plus"></i> åˆ›å»ºä»»åŠ¡
                    </button>
                    <button class="btn secondary" onclick="refreshTasks()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°
                    </button>
                </div>
            </div>

            <div id="tasks-list">
                <!-- ä»»åŠ¡åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </section>

        <!-- åˆ›å»ºæ™ºèƒ½ä½“ -->
        <section id="create-agent" class="content-section">
            <div class="section-header">
                <h2>åˆ›å»ºæ–°æ™ºèƒ½ä½“</h2>
                <button class="btn secondary" onclick="showSection('agents')">
                    <i class="fas fa-arrow-left"></i> è¿”å›åˆ—è¡¨
                </button>
            </div>

            <div class="form-container">
                <form id="agent-form" onsubmit="createAgent(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>æ™ºèƒ½ä½“åç§° *</label>
                            <input type="text" name="name" required placeholder="ä¾‹å¦‚: DataProcessor-05">
                        </div>
                        <div class="form-group">
                            <label>æ™ºèƒ½ä½“ç±»å‹ *</label>
                            <select name="type" required>
                                <option value="">é€‰æ‹©ç±»å‹...</option>
                                <option value="æ•°æ®å¤„ç†å™¨">æ•°æ®å¤„ç†å™¨</option>
                                <option value="ä»»åŠ¡è°ƒåº¦å™¨">ä»»åŠ¡è°ƒåº¦å™¨</option>
                                <option value="çŸ¥è¯†å·¥ä½œè€…">çŸ¥è¯†å·¥ä½œè€…</option>
                                <option value="åè°ƒå™¨">åè°ƒå™¨</option>
                                <option value="APIä»£ç†">APIä»£ç†</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>åŠŸèƒ½æè¿°</label>
                        <textarea name="description" placeholder="æè¿°æ™ºèƒ½ä½“çš„ä¸»è¦åŠŸèƒ½å’Œç”¨é€”..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>CPUæ ¸å¿ƒæ•°</label>
                            <select name="cpu">
                                <option value="1">1 æ ¸å¿ƒ</option>
                                <option value="2" selected>2 æ ¸å¿ƒ</option>
                                <option value="4">4 æ ¸å¿ƒ</option>
                                <option value="8">8 æ ¸å¿ƒ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å†…å­˜åˆ†é…</label>
                            <select name="memory">
                                <option value="512MB">512MB</option>
                                <option value="1GB">1GB</option>
                                <option value="2GB" selected>2GB</option>
                                <option value="4GB">4GB</option>
                                <option value="8GB">8GB</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>æœ€å¤§å¹¶å‘ä»»åŠ¡</label>
                            <input type="number" name="maxTasks" value="5" min="1" max="50">
                        </div>
                        <div class="form-group">
                            <label>ä¼˜å…ˆçº§</label>
                            <select name="priority">
                                <option value="ä½">ä½</option>
                                <option value="ä¸­" selected>ä¸­</option>
                                <option value="é«˜">é«˜</option>
                            </select>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn">
                            <i class="fas fa-plus"></i> åˆ›å»ºæ™ºèƒ½ä½“
                        </button>
                        <button type="button" class="btn secondary" onclick="clearForm('agent-form')">
                            <i class="fas fa-undo"></i> æ¸…ç©ºè¡¨å•
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- åˆ›å»ºä»»åŠ¡ -->
        <section id="create-task" class="content-section">
            <div class="section-header">
                <h2>åˆ›å»ºæ–°ä»»åŠ¡</h2>
                <button class="btn secondary" onclick="showSection('tasks')">
                    <i class="fas fa-arrow-left"></i> è¿”å›åˆ—è¡¨
                </button>
            </div>

            <div class="form-container">
                <form id="task-form" onsubmit="createTask(event)">
                    <div class="form-group">
                        <label>ä»»åŠ¡åç§° *</label>
                        <input type="text" name="name" required placeholder="ä¾‹å¦‚: ç”¨æˆ·æ•°æ®åˆ†æä»»åŠ¡">
                    </div>

                    <div class="form-group">
                        <label>ä»»åŠ¡æè¿°</label>
                        <textarea name="description" placeholder="è¯¦ç»†æè¿°ä»»åŠ¡çš„ç›®æ ‡å’Œè¦æ±‚..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>ä»»åŠ¡ç±»å‹ *</label>
                            <select name="type" required>
                                <option value="">é€‰æ‹©ç±»å‹...</option>
                                <option value="æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</option>
                                <option value="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</option>
                                <option value="æŠ¥å‘Šç”Ÿæˆ">æŠ¥å‘Šç”Ÿæˆ</option>
                                <option value="æ•°æ®åˆ†æ">æ•°æ®åˆ†æ</option>
                                <option value="APIé›†æˆ">APIé›†æˆ</option>
                                <option value="æ–‡æ¡£å¤„ç†">æ–‡æ¡£å¤„ç†</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ä¼˜å…ˆçº§</label>
                            <select name="priority">
                                <option value="ä½">ä½ä¼˜å…ˆçº§</option>
                                <option value="ä¸­" selected>ä¸­ä¼˜å…ˆçº§</option>
                                <option value="é«˜">é«˜ä¼˜å…ˆçº§</option>
                                <option value="ç´§æ€¥">ç´§æ€¥</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>åˆ†é…æ™ºèƒ½ä½“</label>
                            <select name="assignedAgent" id="agent-select">
                                <option value="è‡ªåŠ¨åˆ†é…">è‡ªåŠ¨åˆ†é…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>é¢„è®¡æ‰§è¡Œæ—¶é—´</label>
                            <select name="estimatedTime">
                                <option value="5åˆ†é’Ÿ">5åˆ†é’Ÿ</option>
                                <option value="15åˆ†é’Ÿ">15åˆ†é’Ÿ</option>
                                <option value="30åˆ†é’Ÿ" selected>30åˆ†é’Ÿ</option>
                                <option value="1å°æ—¶">1å°æ—¶</option>
                                <option value="2å°æ—¶">2å°æ—¶</option>
                                <option value="4å°æ—¶">4å°æ—¶</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ä»»åŠ¡å‚æ•° (å¯é€‰)</label>
                        <textarea name="parameters" placeholder='{"inputFile": "data.csv", "outputFormat": "json"}'></textarea>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn">
                            <i class="fas fa-plus"></i> åˆ›å»ºä»»åŠ¡
                        </button>
                        <button type="button" class="btn secondary" onclick="clearForm('task-form')">
                            <i class="fas fa-undo"></i> æ¸…ç©ºè¡¨å•
                        </button>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <script>
        console.log('ğŸš€ åŠŸèƒ½ç‰ˆå¹³å°å¯åŠ¨...');

        // æ•°æ®å­˜å‚¨
        let agents = JSON.parse(localStorage.getItem('platform_agents') || '[]');
        let tasks = JSON.parse(localStorage.getItem('platform_tasks') || '[]');

        // åˆå§‹åŒ–é»˜è®¤æ•°æ®
        if (agents.length === 0) {
            agents = [
                {
                    id: 'agent_1',
                    name: 'DataProcessor-01',
                    type: 'æ•°æ®å¤„ç†å™¨',
                    description: 'ä¸“é—¨å¤„ç†å¤§æ•°æ®æ¸…æ´—å’Œç‰¹å¾æå–ä»»åŠ¡',
                    cpu: '2',
                    memory: '1.2GB',
                    maxTasks: 5,
                    priority: 'ä¸­',
                    status: 'running',
                    currentTasks: 3,
                    createdAt: new Date().toLocaleDateString()
                },
                {
                    id: 'agent_2',
                    name: 'TaskScheduler-01',
                    type: 'ä»»åŠ¡è°ƒåº¦å™¨',
                    description: 'è´Ÿè´£ä»»åŠ¡åˆ†å‘å’Œè´Ÿè½½å‡è¡¡ç®¡ç†',
                    cpu: '2',
                    memory: '856MB',
                    maxTasks: 10,
                    priority: 'é«˜',
                    status: 'running',
                    currentTasks: 7,
                    createdAt: new Date().toLocaleDateString()
                }
            ];
            saveAgents();
        }

        if (tasks.length === 0) {
            tasks = [
                {
                    id: 'task_1',
                    name: 'æ•°æ®æ¸…æ´—ä»»åŠ¡',
                    description: 'æ¸…æ´—ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œæå–å…³é”®ç‰¹å¾',
                    type: 'æ•°æ®å¤„ç†',
                    priority: 'é«˜',
                    assignedAgent: 'DataProcessor-01',
                    estimatedTime: '30åˆ†é’Ÿ',
                    status: 'running',
                    progress: 65,
                    createdAt: new Date().toLocaleDateString()
                },
                {
                    id: 'task_2',
                    name: 'æ¨¡å‹è®­ç»ƒä»»åŠ¡',
                    description: 'è®­ç»ƒç”¨æˆ·ç”»åƒé¢„æµ‹æ¨¡å‹',
                    type: 'æ¨¡å‹è®­ç»ƒ',
                    priority: 'ä¸­',
                    assignedAgent: 'è‡ªåŠ¨åˆ†é…',
                    estimatedTime: '2å°æ—¶',
                    status: 'pending',
                    progress: 0,
                    createdAt: new Date().toLocaleDateString()
                }
            ];
            saveTasks();
        }

        // ä¿å­˜æ•°æ®
        function saveAgents() {
            localStorage.setItem('platform_agents', JSON.stringify(agents));
        }

        function saveTasks() {
            localStorage.setItem('platform_tasks', JSON.stringify(tasks));
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');

            // æ›´æ–°æ™ºèƒ½ä½“é€‰æ‹©åˆ—è¡¨
            if (sectionId === 'create-task') {
                updateAgentSelect();
            }
        }

        // æ¸²æŸ“æ™ºèƒ½ä½“åˆ—è¡¨
        function renderAgents() {
            const agentsList = document.getElementById('agents-list');

            if (agents.length === 0) {
                agentsList.innerHTML = '<div class="error-message">æš‚æ— æ™ºèƒ½ä½“ï¼Œè¯·å…ˆåˆ›å»ºä¸€ä¸ªæ™ºèƒ½ä½“ã€‚</div>';
                return;
            }

            agentsList.innerHTML = agents.map(agent => `
                <div class="agent-card">
                    <div class="agent-header">
                        <div>
                            <div class="agent-name">${agent.name}</div>
                            <div class="agent-type">${agent.type}</div>
                        </div>
                        <div class="agent-status ${agent.status === 'running' ? 'status-running' : 'status-idle'}">
                            ${agent.status === 'running' ? 'è¿è¡Œä¸­' : 'ç©ºé—²'}
                        </div>
                    </div>

                    <div class="agent-metrics">
                        <div class="metric">
                            <div class="metric-value">${agent.cpu}æ ¸</div>
                            <div class="metric-label">CPU</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${agent.memory}</div>
                            <div class="metric-label">å†…å­˜</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${agent.currentTasks || 0}</div>
                            <div class="metric-label">å½“å‰ä»»åŠ¡</div>
                        </div>
                    </div>

                    <p style="margin: 15px 0; color: #666;">${agent.description}</p>
                    <p style="font-size: 0.9em; color: #999;">åˆ›å»ºæ—¶é—´: ${agent.createdAt}</p>

                    <div class="agent-actions">
                        <button class="btn" onclick="editAgent('${agent.id}')">
                            <i class="fas fa-edit"></i> ç¼–è¾‘
                        </button>
                        <button class="btn secondary" onclick="toggleAgent('${agent.id}')">
                            <i class="fas fa-${agent.status === 'running' ? 'pause' : 'play'}"></i>
                            ${agent.status === 'running' ? 'æš‚åœ' : 'å¯åŠ¨'}
                        </button>
                        <button class="btn danger" onclick="deleteAgent('${agent.id}')">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
        function renderTasks() {
            const tasksList = document.getElementById('tasks-list');

            if (tasks.length === 0) {
                tasksList.innerHTML = '<div class="error-message">æš‚æ— ä»»åŠ¡ï¼Œè¯·å…ˆåˆ›å»ºä¸€ä¸ªä»»åŠ¡ã€‚</div>';
                return;
            }

            tasksList.innerHTML = tasks.map(task => `
                <div class="task-card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <h3 style="margin: 0; color: #333;">${task.name}</h3>
                            <p style="margin: 5px 0; color: #666;">${task.type}</p>
                        </div>
                        <span class="task-priority priority-${task.priority === 'é«˜' ? 'high' : task.priority === 'ä¸­' ? 'medium' : 'low'}">
                            ${task.priority}ä¼˜å…ˆçº§
                        </span>
                    </div>

                    <p style="margin: 15px 0; color: #666;">${task.description}</p>

                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>è¿›åº¦: ${task.progress}%</span>
                            <span>çŠ¶æ€: ${task.status === 'running' ? 'è¿è¡Œä¸­' : task.status === 'completed' ? 'å·²å®Œæˆ' : 'ç­‰å¾…ä¸­'}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${task.progress}%"></div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0; font-size: 0.9em;">
                        <div><strong>åˆ†é…æ™ºèƒ½ä½“:</strong> ${task.assignedAgent}</div>
                        <div><strong>é¢„è®¡æ—¶é—´:</strong> ${task.estimatedTime}</div>
                        <div><strong>åˆ›å»ºæ—¶é—´:</strong> ${task.createdAt}</div>
                        <div><strong>ä»»åŠ¡ID:</strong> ${task.id}</div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn" onclick="editTask('${task.id}')">
                            <i class="fas fa-edit"></i> ç¼–è¾‘
                        </button>
                        <button class="btn secondary" onclick="toggleTask('${task.id}')">
                            <i class="fas fa-${task.status === 'running' ? 'pause' : 'play'}"></i>
                            ${task.status === 'running' ? 'æš‚åœ' : 'å¼€å§‹'}
                        </button>
                        <button class="btn danger" onclick="deleteTask('${task.id}')">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // åˆ›å»ºæ™ºèƒ½ä½“
        function createAgent(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const agentData = Object.fromEntries(formData);

            const newAgent = {
                id: 'agent_' + Date.now(),
                name: agentData.name,
                type: agentData.type,
                description: agentData.description || 'æš‚æ— æè¿°',
                cpu: agentData.cpu,
                memory: agentData.memory,
                maxTasks: parseInt(agentData.maxTasks),
                priority: agentData.priority,
                status: 'idle',
                currentTasks: 0,
                createdAt: new Date().toLocaleDateString()
            };

            agents.push(newAgent);
            saveAgents();
            showNotification(`âœ… æ™ºèƒ½ä½“ "${newAgent.name}" åˆ›å»ºæˆåŠŸï¼`, 'success');

            // æ¸…ç©ºè¡¨å•å¹¶è·³è½¬åˆ°åˆ—è¡¨
            event.target.reset();
            showSection('agents');
            renderAgents();
        }

        // åˆ›å»ºä»»åŠ¡
        function createTask(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const taskData = Object.fromEntries(formData);

            const newTask = {
                id: 'task_' + Date.now(),
                name: taskData.name,
                description: taskData.description || 'æš‚æ— æè¿°',
                type: taskData.type,
                priority: taskData.priority,
                assignedAgent: taskData.assignedAgent,
                estimatedTime: taskData.estimatedTime,
                parameters: taskData.parameters,
                status: 'pending',
                progress: 0,
                createdAt: new Date().toLocaleDateString()
            };

            tasks.push(newTask);
            saveTasks();
            showNotification(`âœ… ä»»åŠ¡ "${newTask.name}" åˆ›å»ºæˆåŠŸï¼`, 'success');

            // æ¸…ç©ºè¡¨å•å¹¶è·³è½¬åˆ°åˆ—è¡¨
            event.target.reset();
            showSection('tasks');
            renderTasks();
        }

        // åˆ é™¤æ™ºèƒ½ä½“
        function deleteAgent(agentId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ™ºèƒ½ä½“å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                agents = agents.filter(agent => agent.id !== agentId);
                saveAgents();
                renderAgents();
                showNotification('ğŸ—‘ï¸ æ™ºèƒ½ä½“å·²åˆ é™¤', 'warning');
            }
        }

        // åˆ é™¤ä»»åŠ¡
        function deleteTask(taskId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä»»åŠ¡å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                tasks = tasks.filter(task => task.id !== taskId);
                saveTasks();
                renderTasks();
                showNotification('ğŸ—‘ï¸ ä»»åŠ¡å·²åˆ é™¤', 'warning');
            }
        }

        // åˆ‡æ¢æ™ºèƒ½ä½“çŠ¶æ€
        function toggleAgent(agentId) {
            const agent = agents.find(a => a.id === agentId);
            if (agent) {
                agent.status = agent.status === 'running' ? 'idle' : 'running';
                saveAgents();
                renderAgents();
                showNotification(`${agent.status === 'running' ? 'â–¶ï¸ æ™ºèƒ½ä½“å·²å¯åŠ¨' : 'â¸ï¸ æ™ºèƒ½ä½“å·²æš‚åœ'}`, 'info');
            }
        }

        // åˆ‡æ¢ä»»åŠ¡çŠ¶æ€
        function toggleTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                if (task.status === 'running') {
                    task.status = 'pending';
                    showNotification('â¸ï¸ ä»»åŠ¡å·²æš‚åœ', 'warning');
                } else {
                    task.status = 'running';
                    // æ¨¡æ‹Ÿè¿›åº¦æ›´æ–°
                    if (task.progress < 100) {
                        setTimeout(() => updateTaskProgress(taskId), 2000);
                    }
                    showNotification('â–¶ï¸ ä»»åŠ¡å·²å¼€å§‹', 'success');
                }
                saveTasks();
                renderTasks();
            }
        }

        // æ¨¡æ‹Ÿä»»åŠ¡è¿›åº¦æ›´æ–°
        function updateTaskProgress(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task && task.status === 'running' && task.progress < 100) {
                task.progress += Math.floor(Math.random() * 15) + 5;
                if (task.progress >= 100) {
                    task.progress = 100;
                    task.status = 'completed';
                    showNotification(`âœ… ä»»åŠ¡ "${task.name}" å·²å®Œæˆï¼`, 'success');
                }
                saveTasks();
                renderTasks();

                if (task.status === 'running') {
                    setTimeout(() => updateTaskProgress(taskId), 3000);
                }
            }
        }

        // ç¼–è¾‘åŠŸèƒ½
        function editAgent(agentId) {
            const agent = agents.find(a => a.id === agentId);
            if (agent) {
                // å¡«å……è¡¨å•
                const form = document.getElementById('agent-form');
                form.name.value = agent.name;
                form.type.value = agent.type;
                form.description.value = agent.description;
                form.cpu.value = agent.cpu;
                form.memory.value = agent.memory;
                form.maxTasks.value = agent.maxTasks;
                form.priority.value = agent.priority;

                // ä¿®æ”¹æäº¤è¡Œä¸º
                form.onsubmit = function(event) {
                    event.preventDefault();
                    const formData = new FormData(event.target);
                    const updatedData = Object.fromEntries(formData);

                    Object.assign(agent, updatedData);
                    saveAgents();
                    renderAgents();
                    showNotification(`âœ… æ™ºèƒ½ä½“ "${agent.name}" å·²æ›´æ–°`, 'success');

                    // æ¢å¤åŸå§‹åˆ›å»ºè¡Œä¸º
                    form.onsubmit = createAgent;
                    form.reset();
                    showSection('agents');
                };

                showSection('create-agent');
                showNotification('ğŸ“ æ­£åœ¨ç¼–è¾‘æ™ºèƒ½ä½“ï¼Œä¿®æ”¹åç‚¹å‡»åˆ›å»ºæŒ‰é’®ä¿å­˜', 'info');
            }
        }

        function editTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                // å¡«å……è¡¨å•
                const form = document.getElementById('task-form');
                form.name.value = task.name;
                form.description.value = task.description;
                form.type.value = task.type;
                form.priority.value = task.priority;
                form.assignedAgent.value = task.assignedAgent;
                form.estimatedTime.value = task.estimatedTime;
                form.parameters.value = task.parameters || '';

                // ä¿®æ”¹æäº¤è¡Œä¸º
                form.onsubmit = function(event) {
                    event.preventDefault();
                    const formData = new FormData(event.target);
                    const updatedData = Object.fromEntries(formData);

                    Object.assign(task, updatedData);
                    saveTasks();
                    renderTasks();
                    showNotification(`âœ… ä»»åŠ¡ "${task.name}" å·²æ›´æ–°`, 'success');

                    // æ¢å¤åŸå§‹åˆ›å»ºè¡Œä¸º
                    form.onsubmit = createTask;
                    form.reset();
                    showSection('tasks');
                };

                updateAgentSelect();
                showSection('create-task');
                showNotification('ğŸ“ æ­£åœ¨ç¼–è¾‘ä»»åŠ¡ï¼Œä¿®æ”¹åç‚¹å‡»åˆ›å»ºæŒ‰é’®ä¿å­˜', 'info');
            }
        }

        // æ›´æ–°æ™ºèƒ½ä½“é€‰æ‹©åˆ—è¡¨
        function updateAgentSelect() {
            const select = document.getElementById('agent-select');
            select.innerHTML = '<option value="è‡ªåŠ¨åˆ†é…">è‡ªåŠ¨åˆ†é…</option>';
            agents.forEach(agent => {
                select.innerHTML += `<option value="${agent.name}">${agent.name} (${agent.type})</option>`;
            });
        }

        // æ¸…ç©ºè¡¨å•
        function clearForm(formId) {
            document.getElementById(formId).reset();
            showNotification('ğŸ”„ è¡¨å•å·²æ¸…ç©º', 'info');
        }

        // åˆ·æ–°åŠŸèƒ½
        function refreshAgents() {
            renderAgents();
            showNotification('ğŸ”„ æ™ºèƒ½ä½“åˆ—è¡¨å·²åˆ·æ–°', 'info');
        }

        function refreshTasks() {
            renderTasks();
            showNotification('ğŸ”„ ä»»åŠ¡åˆ—è¡¨å·²åˆ·æ–°', 'info');
        }

        // é€šçŸ¥ç³»ç»Ÿ
        function showNotification(message, type = 'info') {
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                container.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 10000;';
                document.body.appendChild(container);
            }

            const notification = document.createElement('div');
            const colors = {
                success: '#d4edda',
                error: '#f8d7da',
                warning: '#fff3cd',
                info: '#d1ecf1'
            };

            const textColors = {
                success: '#155724',
                error: '#721c24',
                warning: '#856404',
                info: '#0c5460'
            };

            notification.style.cssText = `
                background: ${colors[type] || colors.info};
                color: ${textColors[type] || textColors.info};
                padding: 15px 20px;
                border-radius: 8px;
                margin-bottom: 10px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                max-width: 400px;
                font-weight: 500;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;

            notification.textContent = message;
            container.appendChild(notification);

            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (container.contains(notification)) {
                        container.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderAgents();
            renderTasks();
            updateAgentSelect();
            showNotification('ğŸ‰ åŠŸèƒ½ç‰ˆå¹³å°å·²å°±ç»ªï¼æ‚¨å¯ä»¥å¼€å§‹åˆ›å»ºå’Œç®¡ç†æ™ºèƒ½ä½“ä¸ä»»åŠ¡', 'success');
        });

        console.log('âœ… åŠŸèƒ½ç‰ˆå¹³å°åŠ è½½å®Œæˆ - çœŸæ­£å¯ç”¨ï¼');
    </script>
</body>
</html>